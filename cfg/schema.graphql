# IdeaBase GraphQL Schema
# 版本: 20250311104741

# 自定义标量类型
scalar Json
scalar Cursor
scalar DateTime

# 排序方向枚举
enum SortDirection {
  ASC
  DESC
  ASC_NULLS_FIRST
  DESC_NULLS_FIRST
  ASC_NULLS_LAST
  DESC_NULLS_LAST
}

# 空值条件枚举
enum IsInput {
  NULL
  NOT_NULL
}

# ------------------ 分页相关类型 ------------------

# 页面信息（用于游标分页）
type PageInfo {
  hasNext: Boolean!       # 是否有下一页
  hasPrev: Boolean!       # 是否有上一页
  start: Cursor           # 当前页第一条记录的游标
  end: Cursor             # 当前页最后一条记录的游标
}

# 聚合分组选项
input GroupBy {
  fields: [String!]!  # 分组字段
  having: Json        # 分组过滤条件
  limit: Int          # 分组结果限制
  sort: Json          # 分组结果排序
}

# 用户表
type Users {
  createdAt: DateTime!
  # 用户名
  name: String!
  id: Int!
  # 邮箱
  email: String!
  updatedAt: DateTime
}

# 评论表
type Comments {
  id: Int!
  createdAt: DateTime!
  # 父评论ID
  parentId: Int
  # 评论内容
  content: String!
  # 评论文章
  postId: Int!
  # 评论者
  userId: Int!
}

# 标签表
type Tags {
  # 标签名称
  name: String!
  postList: String!
  createdAt: DateTime!
  id: Int!
}

# 文章表
type Posts {
  # 内容
  content: String
  tagList: String!
  # 作者ID
  userId: Int!
  createdAt: DateTime!
  # 标题
  title: String!
  id: Int!
}

# 文章标签关联表
type PostTags {
  # 标签ID
  tagId: Int!
  createdAt: DateTime!
  # 文章ID
  postId: Int!
}

# 组织表
type Organizations {
  id: Int!
  # 父组织ID
  parentId: Int
  createdAt: DateTime!
  # 组织名称
  name: String!
}

# ------------------ 连接和边类型（游标分页） ------------------

# Posts分页结果
type PostsPage {
  items: [Posts!]!         # 直接返回Posts对象数组
  pageInfo: PageInfo!
  total: Int!
}

# PostTags分页结果
type PostTagsPage {
  items: [PostTags!]!         # 直接返回PostTags对象数组
  pageInfo: PageInfo!
  total: Int!
}

# Organizations分页结果
type OrganizationsPage {
  items: [Organizations!]!         # 直接返回Organizations对象数组
  pageInfo: PageInfo!
  total: Int!
}

# Users分页结果
type UsersPage {
  items: [Users!]!         # 直接返回Users对象数组
  pageInfo: PageInfo!
  total: Int!
}

# Comments分页结果
type CommentsPage {
  items: [Comments!]!         # 直接返回Comments对象数组
  pageInfo: PageInfo!
  total: Int!
}

# Tags分页结果
type TagsPage {
  items: [Tags!]!         # 直接返回Tags对象数组
  pageInfo: PageInfo!
  total: Int!
}

# ------------------ 聚合函数相关类型 ------------------

# 数值聚合结果
type NumberStats {
  sum: Float              # 总和
  avg: Float              # 平均值
  min: Float              # 最小值
  max: Float              # 最大值
  count: Int!             # 计数
  countDistinct: Int!     # 去重计数
}

# 日期聚合结果
type DateTimeStats {
  min: DateTime           # 最早时间
  max: DateTime           # 最晚时间
  count: Int!             # 计数
  countDistinct: Int!     # 去重计数
}

# 字符串聚合结果
type StringStats {
  min: String             # 最小值(按字典序)
  max: String             # 最大值(按字典序)
  count: Int!             # 计数
  countDistinct: Int!     # 去重计数
}

# PostTags聚合
type PostTagsStats {
  count: Int!
  tagId: NumberStats
  createdAt: DateTimeStats
  postId: NumberStats
  # 分组聚合
  groupBy: [PostTagsGroup!]
}

# PostTags分组结果
type PostTagsGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# Organizations聚合
type OrganizationsStats {
  count: Int!
  name: StringStats
  id: NumberStats
  parentId: NumberStats
  createdAt: DateTimeStats
  # 分组聚合
  groupBy: [OrganizationsGroup!]
}

# Organizations分组结果
type OrganizationsGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# Users聚合
type UsersStats {
  count: Int!
  name: StringStats
  id: NumberStats
  email: StringStats
  updatedAt: DateTimeStats
  createdAt: DateTimeStats
  # 分组聚合
  groupBy: [UsersGroup!]
}

# Users分组结果
type UsersGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# Comments聚合
type CommentsStats {
  count: Int!
  id: NumberStats
  createdAt: DateTimeStats
  parentId: NumberStats
  content: StringStats
  postId: NumberStats
  userId: NumberStats
  # 分组聚合
  groupBy: [CommentsGroup!]
}

# Comments分组结果
type CommentsGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# Tags聚合
type TagsStats {
  count: Int!
  id: NumberStats
  name: StringStats
  postList: StringStats
  createdAt: DateTimeStats
  # 分组聚合
  groupBy: [TagsGroup!]
}

# Tags分组结果
type TagsGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# Posts聚合
type PostsStats {
  count: Int!
  tagList: StringStats
  userId: NumberStats
  createdAt: DateTimeStats
  title: StringStats
  id: NumberStats
  content: StringStats
  # 分组聚合
  groupBy: [PostsGroup!]
}

# Posts分组结果
type PostsGroup {
  key: Json!          # 分组键
  count: Int!
  aggregate: [String!]   # 聚合函数列表
  distinct: [String!]    # 去重字段列表
  having: Json        # 分组过滤条件
  limit: Int            # 分组结果限制数量
  sort: Json          # 分组结果排序
}

# ------------------ 过滤器类型定义 ------------------

# Int过滤器
input IntFilter {
  is: IsInput # Is value null (true) or not null (false)
  eq: Int # Equals value
  in: [Int!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
  ne: Int # Does not equal value
}

# Float过滤器
input FloatFilter {
  is: IsInput # Is value null (true) or not null (false)
  eq: Float # Equals value
  in: [Float!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
  ne: Float # Does not equal value
}

# DateTime过滤器
input DateTimeFilter {
  is: IsInput # Is value null (true) or not null (false)
  eq: DateTime # Equals value
  in: [DateTime!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
  ne: DateTime # Does not equal value
}

# String过滤器
input StringFilter {
  is: IsInput # Is value null (true) or not null (false)
  eq: String # Equals value
  in: [String!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
  ne: String # Does not equal value
  like: String # Value matching pattern where '%' represents zero or more characters and '_' represents a single character. Eg. '_r%' finds values having 'r' in second position
  iLike: String # Value matching (case-insensitive) pattern where '%' represents zero or more characters and '_' represents a single character. Eg. '_r%' finds values not having 'r' in second position
  regex: String # Value matching regular pattern
  iRegex: String # Value matching (case-insensitive) regex pattern
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
}

# Boolean过滤器
input BooleanFilter {
  eq: Boolean # Equals value
  in: [Boolean!] # Is in list of values
}

# Json过滤器
input JsonFilter {
  eq: Json # Equals value
  in: [Json!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
}

# ID过滤器
input IDFilter {
  eq: ID # Equals value
  in: [ID!] # Is in list of values
  is: IsInput # Is value null (true) or not null (false)
  hasKey: String # Value is a JSON object with the specified key
  hasKeyAny: String # Value is a JSON object with any of the specified keys
  hasKeyAll: String # Value is a JSON object with all of the specified keys
}

# Posts查询条件
input PostsFilter {
  content: StringFilter
  tagList: StringFilter
  userId: IntFilter
  createdAt: DateTimeFilter
  title: StringFilter
  id: IntFilter
  not: PostsFilter
  and: [PostsFilter!]
  or: [PostsFilter!]
}

# PostTags查询条件
input PostTagsFilter {
  tagId: IntFilter
  createdAt: DateTimeFilter
  postId: IntFilter
  not: PostTagsFilter
  and: [PostTagsFilter!]
  or: [PostTagsFilter!]
}

# Organizations查询条件
input OrganizationsFilter {
  id: IntFilter
  parentId: IntFilter
  createdAt: DateTimeFilter
  name: StringFilter
  not: OrganizationsFilter
  and: [OrganizationsFilter!]
  or: [OrganizationsFilter!]
}

# Users查询条件
input UsersFilter {
  name: StringFilter
  id: IntFilter
  email: StringFilter
  updatedAt: DateTimeFilter
  createdAt: DateTimeFilter
  not: UsersFilter
  and: [UsersFilter!]
  or: [UsersFilter!]
}

# Comments查询条件
input CommentsFilter {
  userId: IntFilter
  id: IntFilter
  createdAt: DateTimeFilter
  parentId: IntFilter
  content: StringFilter
  postId: IntFilter
  not: CommentsFilter
  and: [CommentsFilter!]
  or: [CommentsFilter!]
}

# Tags查询条件
input TagsFilter {
  id: IntFilter
  name: StringFilter
  postList: StringFilter
  createdAt: DateTimeFilter
  not: TagsFilter
  and: [TagsFilter!]
  or: [TagsFilter!]
}

# PostTags排序
input PostTagsSort {
  tagId: SortDirection
  createdAt: SortDirection
  postId: SortDirection
}

# Organizations排序
input OrganizationsSort {
  name: SortDirection
  id: SortDirection
  parentId: SortDirection
  createdAt: SortDirection
}

# Users排序
input UsersSort {
  name: SortDirection
  id: SortDirection
  email: SortDirection
  updatedAt: SortDirection
  createdAt: SortDirection
}

# Comments排序
input CommentsSort {
  id: SortDirection
  createdAt: SortDirection
  parentId: SortDirection
  content: SortDirection
  postId: SortDirection
  userId: SortDirection
}

# Tags排序
input TagsSort {
  createdAt: SortDirection
  id: SortDirection
  name: SortDirection
  postList: SortDirection
}

# Posts排序
input PostsSort {
  content: SortDirection
  tagList: SortDirection
  userId: SortDirection
  createdAt: SortDirection
  title: SortDirection
  id: SortDirection
}

# PostTags创建输入
input PostTagsCreateInput {
  postId: Int!
  tagId: Int!
  createdAt: DateTime!
}

# PostTags更新输入
input PostTagsUpdateInput {
  tagId: Int
  postId: Int
}

# Organizations创建输入
input OrganizationsCreateInput {
  createdAt: DateTime!
  name: String!
  id: Int!
  parentId: Int
}

# Organizations更新输入
input OrganizationsUpdateInput {
  name: String
  parentId: Int
}

# Users创建输入
input UsersCreateInput {
  createdAt: DateTime!
  name: String!
  id: Int!
  email: String!
  updatedAt: DateTime
}

# Users更新输入
input UsersUpdateInput {
  name: String
  email: String
}

# Comments创建输入
input CommentsCreateInput {
  id: Int!
  createdAt: DateTime!
  parentId: Int
  content: String!
  postId: Int!
  userId: Int!
}

# Comments更新输入
input CommentsUpdateInput {
  postId: Int
  userId: Int
  parentId: Int
  content: String
}

# Tags创建输入
input TagsCreateInput {
  id: Int!
  name: String!
  postList: String!
  createdAt: DateTime!
}

# Tags更新输入
input TagsUpdateInput {
  name: String
  postList: String
}

# Posts创建输入
input PostsCreateInput {
  userId: Int!
  createdAt: DateTime!
  title: String!
  id: Int!
  content: String
  tagList: String!
}

# Posts更新输入
input PostsUpdateInput {
  tagList: String
  userId: Int
  title: String
  content: String
}

# 关联操作
input ConnectInput {
  id: ID!
}

# 关系操作
input RelationInput {
  connect: [ID!]
  disconnect: [ID!]
}

# ------------------ 查询和变更 ------------------

# 查询根类型
type Query {
  # 单个Comments查询
  Comments(id: ID!): Comments

  # Comments列表查询
  Comments(
    filter: CommentsFilter
    sort: [CommentsSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): CommentsPage!

  # Comments聚合查询
  CommentsStats(
    filter: CommentsFilter
    groupBy: GroupBy
  ): CommentsStats!
  # 单个Tags查询
  Tags(id: ID!): Tags

  # Tags列表查询
  Tags(
    filter: TagsFilter
    sort: [TagsSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): TagsPage!

  # Tags聚合查询
  TagsStats(
    filter: TagsFilter
    groupBy: GroupBy
  ): TagsStats!
  # 单个Posts查询
  Posts(id: ID!): Posts

  # Posts列表查询
  Posts(
    filter: PostsFilter
    sort: [PostsSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): PostsPage!

  # Posts聚合查询
  PostsStats(
    filter: PostsFilter
    groupBy: GroupBy
  ): PostsStats!
  # 单个PostTags查询
  PostTags(id: ID!): PostTags

  # PostTags列表查询
  PostTags(
    filter: PostTagsFilter
    sort: [PostTagsSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): PostTagsPage!

  # PostTags聚合查询
  PostTagsStats(
    filter: PostTagsFilter
    groupBy: GroupBy
  ): PostTagsStats!
  # 单个Organizations查询
  Organizations(id: ID!): Organizations

  # Organizations列表查询
  Organizations(
    filter: OrganizationsFilter
    sort: [OrganizationsSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): OrganizationsPage!

  # Organizations聚合查询
  OrganizationsStats(
    filter: OrganizationsFilter
    groupBy: GroupBy
  ): OrganizationsStats!
  # 单个Users查询
  Users(id: ID!): Users

  # Users列表查询
  Users(
    filter: UsersFilter
    sort: [UsersSort!]
    # 传统分页参数
    limit: Int
    offset: Int
    # 游标分页参数
    first: Int
    after: Cursor
    last: Int
    before: Cursor
  ): UsersPage!

  # Users聚合查询
  UsersStats(
    filter: UsersFilter
    groupBy: GroupBy
  ): UsersStats!
}

# 变更根类型
type Mutation {
  # 创建Posts
  createPosts(data: PostsCreateInput!): Posts!

  # 更新Posts
  updatePosts(id: ID!, data: PostsUpdateInput!): Posts!

  # 删除Posts
  deletePosts(id: ID!): Boolean!

  # 批量删除Posts
  deletePosts(filter: PostsFilter!): Int!
  # 创建PostTags
  createPostTags(data: PostTagsCreateInput!): PostTags!

  # 更新PostTags
  updatePostTags(id: ID!, data: PostTagsUpdateInput!): PostTags!

  # 删除PostTags
  deletePostTags(id: ID!): Boolean!

  # 批量删除PostTags
  deletePostTags(filter: PostTagsFilter!): Int!
  # 创建Organizations
  createOrganizations(data: OrganizationsCreateInput!): Organizations!

  # 更新Organizations
  updateOrganizations(id: ID!, data: OrganizationsUpdateInput!): Organizations!

  # 删除Organizations
  deleteOrganizations(id: ID!): Boolean!

  # 批量删除Organizations
  deleteOrganizations(filter: OrganizationsFilter!): Int!
  # 创建Users
  createUsers(data: UsersCreateInput!): Users!

  # 更新Users
  updateUsers(id: ID!, data: UsersUpdateInput!): Users!

  # 删除Users
  deleteUsers(id: ID!): Boolean!

  # 批量删除Users
  deleteUsers(filter: UsersFilter!): Int!
  # 创建Comments
  createComments(data: CommentsCreateInput!): Comments!

  # 更新Comments
  updateComments(id: ID!, data: CommentsUpdateInput!): Comments!

  # 删除Comments
  deleteComments(id: ID!): Boolean!

  # 批量删除Comments
  deleteComments(filter: CommentsFilter!): Int!
  # 创建Tags
  createTags(data: TagsCreateInput!): Tags!

  # 更新Tags
  updateTags(id: ID!, data: TagsUpdateInput!): Tags!

  # 删除Tags
  deleteTags(id: ID!): Boolean!

  # 批量删除Tags
  deleteTags(filter: TagsFilter!): Int!
}
